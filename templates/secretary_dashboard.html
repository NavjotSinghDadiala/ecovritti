{% extends "base_sec.html" %}
{% block content %}
<div class="dashboard-hero">
  <div class="dashboard-hero-icon">
    <span class="material-icons" style="font-size:3rem;color:#22c55e;">supervisor_account</span>
  </div>
  <div>
    <h1 class="dashboard-title">Secretary Dashboard</h1>
    <p class="dashboard-sub">Building compliance and resident performance</p>
  </div>
  <div class="dashboard-kpis">
    <div class="kpi-card">
      <div class="kpi-label">Compliance</div>
      <div class="kpi-value" id="kpiCompliance">0%</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-label">Top Score</div>
      <div class="kpi-value" id="kpiTopScore">0 pts</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-label">Residents</div>
      <div class="kpi-value" id="kpiResidents">0</div>
    </div>
  </div>
</div>
<main class="dashboard-main grid grid-2">
  <section class="card dashboard-section">
    <div class="section-title"><span class="material-icons kpi-icon">insights</span> Building Compliance</div>
    <canvas id="complianceChart" height="150"></canvas>
    <table class="table" style="margin-top:12px">
      <thead><tr><th>Week</th><th>Compliance %</th></tr></thead>
      <tbody id="complianceTable"></tbody>
    </table>
  </section>
  <section class="card dashboard-section">
    <div class="section-title"><span class="material-icons kpi-icon">leaderboard</span> Society Leaderboard <span class="badge">Top performers</span></div>
    <div class="leaderboard-card">
      <table class="table" id="leaderboard">
        <thead><tr><th>#</th><th>Name</th><th>Flat</th><th>Score</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</main>
<script src="https://fonts.googleapis.com/icon?family=Material+Icons"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Dummy data for Building Compliance
    const complianceData = [
      { week: "2025-09-01", percent: "92%" },
      { week: "2025-09-08", percent: "88%" },
      { week: "2025-09-15", percent: "95%" },
      { week: "2025-09-22", percent: "90%" }
    ];
    const complianceTable = document.getElementById("complianceTable");
    let total = 0;
    complianceData.forEach(row => {
      complianceTable.insertAdjacentHTML("beforeend", `<tr><td>${row.week}</td><td>${row.percent}</td></tr>`);
      total += parseInt(row.percent);
    });
    document.getElementById("kpiCompliance").textContent = Math.round(total/complianceData.length) + "%";
    // Example mock leaderboard for secretary
    const leaderboard = [
      { name: "Neha Sharma", flat: "B-203", score: "140 pts" },
      { name: "Ravi Patel", flat: "A-305", score: "135 pts" },
      { name: "Amit Kumar", flat: "C-101", score: "120 pts" }
    ];
    document.getElementById("kpiTopScore").textContent = leaderboard[0].score;
    document.getElementById("kpiResidents").textContent = leaderboard.length;
    const leaderboardTable = document.querySelector("#leaderboard tbody");
    leaderboard.forEach((p, i) => {
      const row = `<tr><td>${i+1}</td><td>${p.name}</td><td>${p.flat}</td><td>${p.score}</td></tr>`;
      leaderboardTable.insertAdjacentHTML("beforeend", row);
    });
  });
</script>
{% endblock %}
	